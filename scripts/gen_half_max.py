from jaxRBDL.Utils.ModelWrapper import ModelWrapper
import os
import numpy as np


CURRENT_PATH = os.path.dirname(os.path.realpath(__file__))
print(CURRENT_PATH)
mdlw = ModelWrapper()
mdlw.load(os.path.join(CURRENT_PATH, 'half_max_v0.json'))
mdlw.CoM = np.array([[[0.02019628,],     [-0.00021695,],    [0.00360529,]],
                     [[6.94812146e-05,], [0.00000000e+00,], [-2.42692940e-02,]],
                     [[0.00020018,],     [ 0.0,],           [-0.02110186,]],
                     [[ 0.00142494,],    [ 0.,],            [-0.09543599,]],
                     [[ 0.00102982,],    [0.0,],            [-0.06736051,]]])
mdlw.Mass = np.array([6.939149, 2.12372, 2.102078, 0.4610992, 0.807692])
mdlw.idlinkplot = [3, 3, 4, 5, 6, 7]
mdlw.linkplot = np.array([
    [[0.196], [0.   ], [0.   ]],
    [[-0.196], [ 0.   ], [ 0.   ]],
    [[ 0.    ], [ 0.    ], [-0.2115]],
    [[ 0.    ], [ 0.    ], [-0.2115]],
    [[ 0.   ], [ 0.   ], [-0.265]],
    [[ 0.   ], [ 0.   ], [-0.265]]
    ])

mdlw.idcontact = [6, 7]
mdlw.contactpoint = np.array([
    [[ 0.   ], [ 0.   ], [-0.265]],
    [[ 0.   ], [ 0.   ], [-0.265]]
    ])

mdlw.Inertia = np.array([
      [[ 2.76807152e-02, -1.09660151e-06,  1.31990119e-03],
       [ 8.67000000e-06,  1.55813083e-01, -2.66746453e-05],
       [ 1.49180000e-03, -2.86500000e-05,  1.75328872e-01]],
      [[ 4.95415984e-02,  0.00000000e+00, -3.40000000e-06],
       [ 0.00000000e+00,  1.06843600e-02,  0.00000000e+00],
       [ 0.00000000e+00,  0.00000000e+00,  4.11002584e-02]],
      [[4.79324071e-02, 0.00000000e+00, 5.41600000e-05],
       [0.00000000e+00, 9.48672000e-03, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 4.07098871e-02]],
      [[ 1.87623703e-02,  0.00000000e+00, -1.11359935e-05],
       [ 0.00000000e+00,  4.69359965e-03,  0.00000000e+00],
       [ 0.00000000e+00,  0.00000000e+00,  1.42410937e-02]],
      [[ 3.13021928e-02, -2.60000000e-07,  3.14271111e-05],
       [ 0.00000000e+00,  6.14641157e-03, -3.98000000e-06],
       [ 0.00000000e+00,  0.00000000e+00,  2.54369855e-02]]
    ])
mdlw.NC = 2
mdlw.ST = np.array(
    [[0., 0., 0., 0.],
    [0., 0., 0., 0.],
    [0., 0., 0., 0.],
    [1., 0., 0., 0.],
    [0., 1., 0., 0.],
    [0., 0., 1., 0.],
    [0., 0., 0., 1.]])

mdlw.nf = 2

mdlw.contact_force_lb = np.array([-1000.0, -1000.0, 0.0]).reshape(-1, 1)
mdlw.contact_force_ub = np.array([1000.0, 1000.0, 3000.0]).reshape(-1, 1)
mdlw.contact_force_kp = np.array([10000.0, 10000.0, 10000.0]).reshape(-1, 1)
mdlw.contact_force_kd = np.array([1000.0, 1000.0, 1000.0]).reshape(-1, 1)

mdlw.contact_pos_lb = np.array([0.0001, 0.0001, 0.0001]).reshape(-1, 1)
mdlw.contact_pos_ub = np.array([0.0001, 0.0001, 0.0001]).reshape(-1, 1)
mdlw.contact_vel_lb = np.array([-0.05, -0.05, -0.05]).reshape(-1, 1)
mdlw.contact_vel_ub = np.array([0.01, 0.01, 0.01]).reshape(-1, 1)



mdlw.save(os.path.join(CURRENT_PATH, 'half_max_v1.json'))